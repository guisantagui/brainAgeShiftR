# brainAgeShiftR

## Overview
An R package for detecting shifts in transcriptomic age in samples originating from human brain cells or tissues. Starting from a **matrix of gene counts**, and a set of experimental factors and comparisons:
- Performs preprocessing steps.
- Computes **transcriptomic age**.
- Detects **significant transcriptomic age shifts**.
- Identifies the **genes driving these shifts**.

## Installation

### From GitHub

```r
if (!require("devtools", quietly = T))
{
	install.packages("devtools")
}

devtools::install_github("guisantagui/brainAgeShiftR")
```

## Usage
Here's a basic example of how to use **brainAgeShiftR**

### Load the package
```r
library(brainAgeShiftR)
```
### Load example data
The example data consists on transcriptomic data from neurons trans-differentiated from fibroblasts originating from either healthy controls (`HC`) or late-onset Alzheimer's disease (`LOAD`), generated by Sun et al. in 2024.
```r
data(example_data)
```
### Create a `brainAgeShiftObj`
```r
baso_load_vs_hc <- create_brainAgeShiftObj(counts_4DE,
                                           metdat_4DE,
                                           "pheno",
                                           c("HC", "LOAD"))
```
### Normalize the counts data
```r
baso_load_vs_hc <- normalizeCounts(baso_load_vs_hc)
```
### Compute transcriptomic age
```r
baso_load_vs_hc <- predictAge(baso_load_vs_hc)
```
### Compute significance of the transcriptomic age shift of the comparison.
```r
baso_load_vs_hc <- do_signTest(baso_load_vs_hc, adjust_method = "BH")
```
# Get the genes that are significantly contributing to the shift
```r
baso_load_vs_hc <- get_signGenes(baso_load_vs_hc, alpha_comparisons = .05)
```
